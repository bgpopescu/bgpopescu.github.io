#| echo: true
library(sf)
library(rnaturalearth)
world <- ne_countries(scale = "medium", returnclass = "sf")
world2<-subset(world, select = c(admin, adm0_a3, sovereignt, continent))
st_write(world2, "world.shp")
#| echo: true
library(sf)
library(rnaturalearth)
world <- ne_countries(scale = "medium", returnclass = "sf")
world2<-subset(world, select = c(admin, adm0_a3, sovereignt, continent))
st_write(world2, "/data/world.shp")
#| echo: true
library(sf)
library(rnaturalearth)
world <- ne_countries(scale = "medium", returnclass = "sf")
world2<-subset(world, select = c(admin, adm0_a3, sovereignt, continent))
st_write(world2, "./data/world.shp")
#| echo: true
#Step1: Loading the data
world <- read_sf(dsn = "./world_shp/world.shp", layer = "SHAPEFILE")
knitr::opts_chunk$set(fig.width = 9, fig.height = 4)
#Setting path
library("dplyr")
setwd("/Users/bgpopescu/Library/CloudStorage/Dropbox/john_cabot/teaching/big_data/week5/data/")
#Step1: Loading the data
life_expectancy <- read.csv(file = './life-expectancy.csv')
urbanization <- read.csv(file = './share-of-population-urban.csv')
life_expectancy<-subset(life_expectancy, Year>1900)
urbanization<-subset(urbanization, Year>1900)
life_expectancy2<-life_expectancy%>%
group_by(Code, Entity)%>%
summarize(life_expectancy=mean(Life.expectancy.at.birth..historical.))
#Removing continents
life_expectancy3<-subset(life_expectancy2, life_expectancy2$Code!="")
#Selecting only relevant vars
#Removing unnecessary files
rm(life_expectancy, life_expectancy2)
#EU Countries
eu_countries<-c("Austria",
"Belgium",
"Bulgaria",
"Croatia",
"Cyprus",
"Czechia",
"Denmark",
"Estonia",
"Finland",
"France",
"Germany",
"Greece",
"Hungary",
"Ireland",
"Italy",
"Latvia",
"Lithuania",
"Luxembourg",
"Malta",
"Netherlands",
"Poland",
"Portugal",
"Romania",
"Slovakia",
"Slovenia",
"Spain",
"Sweden")
latam_countries<-c("Belize",
"Costa Rica",
"El Salvador",
"Guatemala",
"Honduras",
"Mexico",
"Nicaragua",
"Panama",
"Argentina",
"Bolivia",
"Brazil",
"Chile",
"Colombia",
"Ecuador",
"Guyana",
"Paraguay",
"Peru",
"Suriname",
"Uruguay",
"Venezuela",
"Cuba",
"Dominican Republic",
"Haiti")
life_expectancy3$continent[life_expectancy3$Entity  %in% eu_countries]<-"EU"
#unique(life_expectancy3$continent)
urbanization2<-urbanization%>%
group_by(Code)%>%
summarize(urbanization=mean(Urban.population....of.total.population.))
#Removing continents
urbanization3<-subset(urbanization2, urbanization2$Code!="")
#Selecting only relevant vars
#Removing unnecessary dataframes
rm(urbanization, urbanization2)
final<-left_join(life_expectancy3, urbanization3, by = c("Code"="Code"))
#Removing unnecessary dataframes
rm(life_expectancy3, urbanization3)
#final_new<-na.omit(final)
final_new<-subset(final, select = c(Entity, Code, life_expectancy, urbanization))
final_new$type<-NA
final_new$type<-"Everything Else"
final_new$type[final_new$Entity %in% latam_countries]<-"Latin America"
final_new$type[final_new$Entity %in% eu_countries]<-"EU"
#write.csv(final_new, "/Users/bgpopescu/Library/CloudStorage/Dropbox/john_cabot/teaching/big_data/week4/data/life_exp_urb.csv", row.names=FALSE)
library(sf)
library(rnaturalearth)
world <- ne_countries(scale = "medium", returnclass = "sf")
world2<-subset(world, select = c(admin, adm0_a3, sovereignt, continent))
merged<-left_join(world2, final_new, by = c("adm0_a3" = "Code"))
#glimpse(merged)
library(ggplot2)
ggplot() +
geom_sf() +
geom_sf(data = merged, aes(fill = life_expectancy))
ggplot() +
geom_sf() +
geom_sf(data = merged, aes(fill = life_expectancy))
#| echo: false
library(sf)
library(rnaturalearth)
world <- ne_countries(scale = "medium", returnclass = "sf")
world2<-subset(world, select = c(admin, adm0_a3, sovereignt, continent))
#st_write(world2, "./data/world_shp/world.shp")
#| echo: true
#Setting path
library("dplyr")
setwd("/Users/bgpopescu/Library/CloudStorage/Dropbox/john_cabot/teaching/big_data/week5/data/")
#Step1: Loading the data
life_expectancy <- read.csv(file = './life_exp_urb.csv')
head(life_expectancy, n=3)
#| echo: true
#Step1: Loading the data
world <- read_sf(dsn = "./world_shp/world.shp", layer = "SHAPEFILE")
#| echo: true
#Step1: Loading the data
world <- read_sf(dsn = ".\world_shp\world.shp", layer = "SHAPEFILE")
#| echo: true
#Step1: Loading the data
world <- read_sf(dsn = "./world_shp/world", layer = "SHAPEFILE")
#| echo: true
#Step1: Loading the data
world <- read_sf(dsn = "./world_shp/world", layer = "SHAPEFILE")
#| echo: true
#Step1: Loading the data
world <- read_sf(dsn = "./world_shp/world.shp", layer = "SHAPEFILE")
#| echo: true
#Step1: Loading the data
world <- read_sf(dsn = "/Users/bgpopescu/Library/CloudStorage/Dropbox/john_cabot/teaching/big_data/week5/data/world_shp/world.shp", layer = "SHAPEFILE")
#| echo: true
#Step1: Loading the data
world <- read_sf(dsn = "/Users/bgpopescu/Library/CloudStorage/Dropbox/john_cabot/teaching/big_data/week5/data/world_shp/world.shp")
head(world, n=3)
#| echo: true
#Step1: Loading the data
world <- read_sf(dsn = "./world_shp/world.shp")
#| echo: true
#Step1: Loading the data
setwd("/Users/bgpopescu/Library/CloudStorage/Dropbox/john_cabot/teaching/big_data/week5/data/")
world <- read_sf(dsn = "./world_shp/world.shp")
head(world, n=3)
list.files("./world_shp/")
list.files("/Users/bgpopescu/Library/CloudStorage/Dropbox/john_cabot/teaching/big_data/week5/data/world_shp/")
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
install.packages("purrr")
#Removing previous datasets in memory
rm(list = ls())
#Loading the relevant libraries
library(ggplot2)
library(gridExtra)
library(dplyr)
library(purrr)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(ggrepel)
#Setting path
setwd("/Users/bgpopescu/Dropbox/john_cabot/teaching/stats/lab8/")
#Step1: Loading the data
life_expectancy <- read.csv(file = './life-expectancy.csv')
urbanization <- read.csv(file = './share-of-population-urban.csv')
View(life_expectancy)
View(life_expectancy)
#Step1: Calculating the mean
life_expectancy2<-life_expectancy%>%
group_by(Code, Entity)%>%
summarize(life_expectancy=mean(Life.expectancy.at.birth..historical.))
#Step2: Cleaning the Data
weird_labels <- c("OWID_KOS", "OWID_WRL", "")
clean_countries<-subset(life_expectancy2, !(Code %in% weird_labels))
head(clean_countries, n=5)
glimpse(clean_countries)
world <- ne_countries(scale = "medium", returnclass = "sf")
View(world)
View(clean_countries)
class(clean_countries)
class(world)
glimpse(world)
class(world)
#glimpse(world)
#class(world)
glimpse(world)
ggplot() +
geom_sf(data = world)
glimpse(world, n = 3)
world2<-subset(world, select = c(admin, adm0_a3, sovereignt, continent))
#glimpse(world2)
View(world2)
world2<-subset(world, select = c(admin, adm0_a3, sovereignt, continent))
glimpse(world2)
world2$adm0_a3
ctries_sp<-world2$adm0_a3
ctries_sp
ctries_sp<-world2$adm0_a3
glimpse(ctries_sp)
ctries_sp<-world2$adm0_a3
glimpse(ctries_sp)
ctries_df<-clean_countries$Code
glimpse(ctries_df)
countries_dif<-setdiff(ctries_sp, ctries_df)
countries_dif
world3<-subset(world2, adm0_a3 %in% countries_dif)
head(world3, n = 10)
list(world3$admin)[[1]]
world2$adm0_a3
world2$adm0_a3
clean_countries$Code
merged<-left_join(world2, clean_countries, by = c("adm0_a3" = "Code"))
glimpse(merged, n = 4)
ggplot() +
geom_sf(data = merged, aes(fill = life_expectancy))
ggplot() +
geom_sf(data = merged, aes(fill = life_expectancy))+
theme_bw()+
xlab("X - Longitude") + ylab("Y - Latitude")+
scale_y_continuous(breaks=seq(-90, 90, by = 10), limits = c(-90,90))
sample_latam<-subset(merged, continent=="South America")
sample_latam<-subset(merged, continent=="South America")
ggplot() +
geom_sf(data = sample_latam, aes(fill = life_expectancy))+
theme_bw()+
xlab("X - Longitude") + ylab("Y - Latitude")
world_nolatam<-subset(merged, continent!="South America")
glimpse(world_nolatam)
t.test(sample_latam$life_expectancy,
mu=mean(world_nolatam$life_expectancy, na.rm=T),
sigma.x=sd(sample_latam$life_expectancy),
alternative = c("greater"))
t.test(sample_latam$life_expectancy,
mu=mean(world_nolatam$life_expectancy, na.rm=T),
sigma.x=sd(sample_latam$life_expectancy),
alternative = c("less"))
t.test(sample_latam$life_expectancy,
mu=mean(world_nolatam$life_expectancy, na.rm=T),
sigma.x=sd(sample_latam$life_expectancy),
alternative = c("two.sided"))
merged$sample<-NA
merged$sample<-"Rest of the World"
merged$sample[merged$continent=="South America"]<-"South America"
ggplot(merged, aes(x = sample, y = life_expectancy, color = sample)) +
geom_boxplot() +
geom_jitter() +
theme_bw()
