<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bogdan G. Popescu">

<title>Lab 4: Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="lab4_questions_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab4_questions_files/libs/quarto-html/quarto.js"></script>
<script src="lab4_questions_files/libs/quarto-html/popper.min.js"></script>
<script src="lab4_questions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab4_questions_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab4_questions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab4_questions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab4_questions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab4_questions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab4_questions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro-to-ggplot" id="toc-intro-to-ggplot" class="nav-link active" data-scroll-target="#intro-to-ggplot"><span class="toc-section-number">1</span>  Intro to ggplot</a></li>
  <li><a href="#loading-the-data" id="toc-loading-the-data" class="nav-link" data-scroll-target="#loading-the-data"><span class="toc-section-number">2</span>  Loading the Data</a></li>
  <li><a href="#creating-a-scatterplot" id="toc-creating-a-scatterplot" class="nav-link" data-scroll-target="#creating-a-scatterplot"><span class="toc-section-number">3</span>  Creating a scatterplot</a>
  <ul class="collapse">
  <li><a href="#create-averages" id="toc-create-averages" class="nav-link" data-scroll-target="#create-averages"><span class="toc-section-number">3.1</span>  Create averages</a></li>
  <li><a href="#inspect-the-first-5-entries-of-each-new-dataframe" id="toc-inspect-the-first-5-entries-of-each-new-dataframe" class="nav-link" data-scroll-target="#inspect-the-first-5-entries-of-each-new-dataframe"><span class="toc-section-number">3.2</span>  Inspect the first 5 entries of each new dataframe</a></li>
  <li><a href="#cleaning-our-dataset" id="toc-cleaning-our-dataset" class="nav-link" data-scroll-target="#cleaning-our-dataset"><span class="toc-section-number">3.3</span>  Cleaning our dataset</a></li>
  <li><a href="#performing-a-left-merge" id="toc-performing-a-left-merge" class="nav-link" data-scroll-target="#performing-a-left-merge"><span class="toc-section-number">3.4</span>  Performing a left merge</a></li>
  <li><a href="#getting-rid-of-nas-for-urbanization" id="toc-getting-rid-of-nas-for-urbanization" class="nav-link" data-scroll-target="#getting-rid-of-nas-for-urbanization"><span class="toc-section-number">3.5</span>  Getting rid of NAs for urbanization</a></li>
  <li><a href="#doing-a-scatterplot" id="toc-doing-a-scatterplot" class="nav-link" data-scroll-target="#doing-a-scatterplot"><span class="toc-section-number">3.6</span>  Doing a scatterplot</a></li>
  <li><a href="#saving-our-first-plot" id="toc-saving-our-first-plot" class="nav-link" data-scroll-target="#saving-our-first-plot"><span class="toc-section-number">3.7</span>  Saving our first plot</a></li>
  </ul></li>
  <li><a href="#ggplot-options" id="toc-ggplot-options" class="nav-link" data-scroll-target="#ggplot-options"><span class="toc-section-number">4</span>  ggplot options</a>
  <ul class="collapse">
  <li><a href="#improving-x-and-y-axis-labels" id="toc-improving-x-and-y-axis-labels" class="nav-link" data-scroll-target="#improving-x-and-y-axis-labels"><span class="toc-section-number">4.1</span>  Improving X and Y axis labels</a></li>
  <li><a href="#adding-a-title" id="toc-adding-a-title" class="nav-link" data-scroll-target="#adding-a-title"><span class="toc-section-number">4.2</span>  Adding a Title</a></li>
  <li><a href="#getting-rid-of-the-grey-background" id="toc-getting-rid-of-the-grey-background" class="nav-link" data-scroll-target="#getting-rid-of-the-grey-background"><span class="toc-section-number">4.3</span>  Getting rid of the grey background</a></li>
  <li><a href="#fitting-a-line" id="toc-fitting-a-line" class="nav-link" data-scroll-target="#fitting-a-line"><span class="toc-section-number">4.4</span>  Fitting a line</a></li>
  <li><a href="#fixing-the-x-and-y-axis-to-particular-values" id="toc-fixing-the-x-and-y-axis-to-particular-values" class="nav-link" data-scroll-target="#fixing-the-x-and-y-axis-to-particular-values"><span class="toc-section-number">4.5</span>  Fixing the X and Y axis to particular values</a></li>
  <li><a href="#labelling-the-data" id="toc-labelling-the-data" class="nav-link" data-scroll-target="#labelling-the-data"><span class="toc-section-number">4.6</span>  Labelling the data</a></li>
  <li><a href="#subsetting-the-data-to-two-countries" id="toc-subsetting-the-data-to-two-countries" class="nav-link" data-scroll-target="#subsetting-the-data-to-two-countries"><span class="toc-section-number">4.7</span>  Subsetting the data to two countries</a></li>
  <li><a href="#lets-try-the-labelling-again" id="toc-lets-try-the-labelling-again" class="nav-link" data-scroll-target="#lets-try-the-labelling-again"><span class="toc-section-number">4.8</span>  Let’s try the labelling again</a></li>
  </ul></li>
  <li><a href="#creating-a-bar-plot" id="toc-creating-a-bar-plot" class="nav-link" data-scroll-target="#creating-a-bar-plot"><span class="toc-section-number">5</span>  Creating a bar plot</a>
  <ul class="collapse">
  <li><a href="#calculating-the-mean" id="toc-calculating-the-mean" class="nav-link" data-scroll-target="#calculating-the-mean"><span class="toc-section-number">5.1</span>  Calculating the mean</a></li>
  <li><a href="#adding-the-mean-to-the-graph" id="toc-adding-the-mean-to-the-graph" class="nav-link" data-scroll-target="#adding-the-mean-to-the-graph"><span class="toc-section-number">5.2</span>  Adding the mean to the graph</a></li>
  </ul></li>
  <li><a href="#creating-a-line-plot" id="toc-creating-a-line-plot" class="nav-link" data-scroll-target="#creating-a-line-plot"><span class="toc-section-number">6</span>  Creating a line plot</a>
  <ul class="collapse">
  <li><a href="#subsetting-the-sample-to-fewer-countries" id="toc-subsetting-the-sample-to-fewer-countries" class="nav-link" data-scroll-target="#subsetting-the-sample-to-fewer-countries"><span class="toc-section-number">6.1</span>  Subsetting the sample to fewer countries</a></li>
  <li><a href="#subsetting-the-sample-to-fewer-years" id="toc-subsetting-the-sample-to-fewer-years" class="nav-link" data-scroll-target="#subsetting-the-sample-to-fewer-years"><span class="toc-section-number">6.2</span>  Subsetting the sample to fewer years</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 4: Statistics</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bogdan G. Popescu </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="intro-to-ggplot" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Intro to ggplot</h1>
<p>ggplot2 in R is one of the most elegant and most versatile graphing libraries in R. It implements the grammar of graphics, a coherent system for describing and building graphs.</p>
<p>In this lab, we will cover the basics of ggplot. We will start by creating simple scatterplots and use that to introduce <strong>aesthetic mappings</strong> and <strong>geometric objects</strong>.</p>
<p>We will then walk through visualizing distributions of single variables as well as visualizing relationships between two variables. We’ll finish off with saving your plots and troubleshooting tips.</p>
</section>
<section id="loading-the-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Loading the Data</h1>
<p>Let’s go back to our old datasets: life expectancy and urbanization. Let’s open them first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting path</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"/Users/bgpopescu/Dropbox/john_cabot/teaching/stats/lab4/"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>life_expectancy <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">'./life-expectancy.csv'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>urbanization <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">'./share-of-population-urban.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you don’t have them anymore, you can download them from the following links:</p>
<ul>
<li><a href="https://www.dropbox.com/s/jkonhd05avrswyk/life-expectancy.csv?dl=0" target="_blank">Life expectancy data</a></li>
<li><a href="https://www.dropbox.com/s/edwjhyk074b0xh0/share-of-population-urban.csv?dl=0" target="_blank">Urbanization data</a></li>
</ul>
<p>We should now have in memory the two datasets. Let’s inspect the first 5 entries in both dataframes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(life_expectancy, <span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Entity Code Year Life.expectancy.at.birth..historical.
1 Afghanistan  AFG 1950                                  27.7
2 Afghanistan  AFG 1951                                  28.0
3 Afghanistan  AFG 1952                                  28.4
4 Afghanistan  AFG 1953                                  28.9
5 Afghanistan  AFG 1954                                  29.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(urbanization, <span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Entity Code Year Urban.population....of.total.population.
1 Afghanistan  AFG 1960                                    8.401
2 Afghanistan  AFG 1961                                    8.684
3 Afghanistan  AFG 1962                                    8.976
4 Afghanistan  AFG 1963                                    9.276
5 Afghanistan  AFG 1964                                    9.586</code></pre>
</div>
</div>
</section>
<section id="creating-a-scatterplot" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Creating a scatterplot</h1>
<p>Let’s say that we want to create a scatterplot depicting the relationship between urbanization and life expectancy. The first thing we need to do is to calculate averages per country. We will proceed as we did previously.</p>
<section id="create-averages" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="create-averages"><span class="header-section-number">3.1</span> Create averages</h2>
<p>The next step is to create averages for all the countries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>life_expectancy2 <span class="ot">&lt;-</span> life_expectancy <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Code, Entity) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">life_expectancy =</span> <span class="fu">mean</span>(Life.expectancy.at.birth..historical.))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>urbanization2 <span class="ot">&lt;-</span> urbanization <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Code) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">urbanization =</span> <span class="fu">mean</span>(Urban.population....of.total.population.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inspect-the-first-5-entries-of-each-new-dataframe" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="inspect-the-first-5-entries-of-each-new-dataframe"><span class="header-section-number">3.2</span> Inspect the first 5 entries of each new dataframe</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(life_expectancy2, <span class="at">n =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   Code [1]
  Code  Entity   life_expectancy
  &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;
1 ""    Africa              49.7
2 ""    Americas            66.8
3 ""    Asia                59.2
4 ""    Europe              69.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(urbanization2, <span class="at">n =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  Code  urbanization
  &lt;chr&gt;        &lt;dbl&gt;
1 ""            47.7
2 "ABW"         48.1
3 "AFG"         18.6
4 "AGO"         37.5</code></pre>
</div>
</div>
<p>We see that some some entries do not have a code. Why is that? Let’s have a quick look at the original datasets and see what the issue is with those which do not have a code. Let’s first inspect the unique values in Code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(life_expectancy<span class="sc">$</span>Code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "AFG"      ""         "ALB"      "DZA"      "ASM"      "AND"     
  [7] "AGO"      "AIA"      "ATG"      "ARG"      "ARM"      "ABW"     
 [13] "AUS"      "AUT"      "AZE"      "BHS"      "BHR"      "BGD"     
 [19] "BRB"      "BLR"      "BEL"      "BLZ"      "BEN"      "BMU"     
 [25] "BTN"      "BOL"      "BES"      "BIH"      "BWA"      "BRA"     
 [31] "VGB"      "BRN"      "BGR"      "BFA"      "BDI"      "KHM"     
 [37] "CMR"      "CAN"      "CPV"      "CYM"      "CAF"      "TCD"     
 [43] "CHL"      "CHN"      "COL"      "COM"      "COG"      "COK"     
 [49] "CRI"      "CIV"      "HRV"      "CUB"      "CUW"      "CYP"     
 [55] "CZE"      "COD"      "DNK"      "DJI"      "DMA"      "DOM"     
 [61] "ECU"      "EGY"      "SLV"      "GNQ"      "ERI"      "EST"     
 [67] "SWZ"      "ETH"      "FRO"      "FLK"      "FJI"      "FIN"     
 [73] "FRA"      "GUF"      "PYF"      "GAB"      "GMB"      "GEO"     
 [79] "DEU"      "GHA"      "GIB"      "GRC"      "GRL"      "GRD"     
 [85] "GLP"      "GUM"      "GTM"      "GGY"      "GIN"      "GNB"     
 [91] "GUY"      "HTI"      "HND"      "HKG"      "HUN"      "ISL"     
 [97] "IND"      "IDN"      "IRN"      "IRQ"      "IRL"      "IMN"     
[103] "ISR"      "ITA"      "JAM"      "JPN"      "JEY"      "JOR"     
[109] "KAZ"      "KEN"      "KIR"      "OWID_KOS" "KWT"      "KGZ"     
[115] "LAO"      "LVA"      "LBN"      "LSO"      "LBR"      "LBY"     
[121] "LIE"      "LTU"      "LUX"      "MAC"      "MDG"      "MWI"     
[127] "MYS"      "MDV"      "MLI"      "MLT"      "MHL"      "MTQ"     
[133] "MRT"      "MUS"      "MYT"      "MEX"      "FSM"      "MDA"     
[139] "MCO"      "MNG"      "MNE"      "MSR"      "MAR"      "MOZ"     
[145] "MMR"      "NAM"      "NRU"      "NPL"      "NLD"      "NCL"     
[151] "NZL"      "NIC"      "NER"      "NGA"      "NIU"      "PRK"     
[157] "MKD"      "MNP"      "NOR"      "OMN"      "PAK"      "PLW"     
[163] "PSE"      "PAN"      "PNG"      "PRY"      "PER"      "PHL"     
[169] "POL"      "PRT"      "PRI"      "QAT"      "REU"      "ROU"     
[175] "RUS"      "RWA"      "SHN"      "KNA"      "LCA"      "MAF"     
[181] "SPM"      "VCT"      "WSM"      "SMR"      "STP"      "SAU"     
[187] "SEN"      "SRB"      "SYC"      "SLE"      "SGP"      "SXM"     
[193] "SVK"      "SVN"      "SLB"      "SOM"      "ZAF"      "KOR"     
[199] "SSD"      "ESP"      "LKA"      "SDN"      "SUR"      "SWE"     
[205] "CHE"      "SYR"      "TWN"      "TJK"      "TZA"      "THA"     
[211] "TLS"      "TGO"      "TKL"      "TON"      "TTO"      "TUN"     
[217] "TUR"      "TKM"      "TCA"      "TUV"      "UGA"      "UKR"     
[223] "ARE"      "GBR"      "USA"      "VIR"      "URY"      "UZB"     
[229] "VUT"      "VAT"      "VEN"      "VNM"      "WLF"      "ESH"     
[235] "OWID_WRL" "YEM"      "ZMB"      "ZWE"     </code></pre>
</div>
</div>
<p>So we have some unusual entries such as ““,”OWID_KOS” or “OWID_WRL”. What are these countries? We can do a subset to answer this question.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>weird_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"OWID_KOS"</span>, <span class="st">"OWID_WRL"</span>, <span class="st">""</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>weird_countries <span class="ot">&lt;-</span> <span class="fu">subset</span>(life_expectancy2, (Code <span class="sc">%in%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    weird_labels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s inspect them by verifying unique countries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>weird_countries2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(weird_countries, <span class="sc">!</span><span class="fu">duplicated</span>(weird_countries<span class="sc">$</span>Entity))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(weird_countries2, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
# Groups:   Code [1]
   Code  Entity                                  life_expectancy
   &lt;chr&gt; &lt;chr&gt;                                             &lt;dbl&gt;
 1 ""    Africa                                             49.7
 2 ""    Americas                                           66.8
 3 ""    Asia                                               59.2
 4 ""    Europe                                             69.0
 5 ""    High-income countries                              73.9
 6 ""    Land-locked Developing Countries (LLDC)            50.8
 7 ""    Latin America and the Caribbean                    64.6
 8 ""    Least developed countries                          49.8
 9 ""    Less developed regions                             58.4
10 ""    Less developed regions, excluding China            56.8</code></pre>
</div>
</div>
<p>So what is the problem with these data?</p>
<p>The problem is that these are aggregates that were decided by Our World in Data. So, we should remove them from the data. The way to do that is subsetting them based on the names that seemed problematic. Note the difference in code from before <code>!(Code %% weird_labels)</code> vs.&nbsp;<code>(Code %% weird_labels)</code></p>
</section>
<section id="cleaning-our-dataset" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="cleaning-our-dataset"><span class="header-section-number">3.3</span> Cleaning our dataset</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>weird_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"OWID_KOS"</span>, <span class="st">"OWID_WRL"</span>, <span class="st">""</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>clean_countries<span class="ot">&lt;-</span><span class="fu">subset</span>(life_expectancy2, <span class="sc">!</span>(Code <span class="sc">%in%</span> weird_labels))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(clean_countries, <span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
# Groups:   Code [5]
  Code  Entity      life_expectancy
  &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt;
1 ABW   Aruba                  70.3
2 AFG   Afghanistan            45.4
3 AGO   Angola                 45.1
4 AIA   Anguilla               69.4
5 ALB   Albania                68.3</code></pre>
</div>
</div>
<p>Great! Let’s repeat the procedure for urbanization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>weird_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"OWID_KOS"</span>, <span class="st">"OWID_WRL"</span>, <span class="st">""</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>clean_countries_urbanization<span class="ot">&lt;-</span><span class="fu">subset</span>(urbanization2, <span class="sc">!</span>(Code <span class="sc">%in%</span> weird_labels))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(clean_countries_urbanization, <span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  Code  urbanization
  &lt;chr&gt;        &lt;dbl&gt;
1 ABW           48.1
2 AFG           18.6
3 AGO           37.5
4 ALB           40.4
5 AND           87.0</code></pre>
</div>
</div>
</section>
<section id="performing-a-left-merge" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="performing-a-left-merge"><span class="header-section-number">3.4</span> Performing a left merge</h2>
<p>We will now perform a left merge whereby we try to merge urbanization data to life expectancy based on Code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>new_data<span class="ot">&lt;-</span><span class="fu">left_join</span>(clean_countries, clean_countries_urbanization, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Code"</span><span class="ot">=</span><span class="st">"Code"</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(new_data, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   Code [10]
   Code  Entity               life_expectancy urbanization
   &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;        &lt;dbl&gt;
 1 ABW   Aruba                           70.3         48.1
 2 AFG   Afghanistan                     45.4         18.6
 3 AGO   Angola                          45.1         37.5
 4 AIA   Anguilla                        69.4         NA  
 5 ALB   Albania                         68.3         40.4
 6 AND   Andorra                         77.0         87.0
 7 ARE   United Arab Emirates            66.1         80.7
 8 ARG   Argentina                       65.4         85.3
 9 ARM   Armenia                         67.2         63.1
10 ASM   American Samoa                  68.6         79.8</code></pre>
</div>
</div>
</section>
<section id="getting-rid-of-nas-for-urbanization" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="getting-rid-of-nas-for-urbanization"><span class="header-section-number">3.5</span> Getting rid of NAs for urbanization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>new_data2<span class="ot">&lt;-</span><span class="fu">subset</span>(<span class="fu">na.omit</span>(new_data))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(new_data2, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   Code [10]
   Code  Entity               life_expectancy urbanization
   &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;        &lt;dbl&gt;
 1 ABW   Aruba                           70.3         48.1
 2 AFG   Afghanistan                     45.4         18.6
 3 AGO   Angola                          45.1         37.5
 4 ALB   Albania                         68.3         40.4
 5 AND   Andorra                         77.0         87.0
 6 ARE   United Arab Emirates            66.1         80.7
 7 ARG   Argentina                       65.4         85.3
 8 ARM   Armenia                         67.2         63.1
 9 ASM   American Samoa                  68.6         79.8
10 ATG   Antigua and Barbuda             71.2         32.4</code></pre>
</div>
</div>
<p>How many countries did we drop?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(new_data) <span class="sc">-</span> <span class="fu">nrow</span>(new_data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21</code></pre>
</div>
</div>
<p>What are those countries?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>countries_dropped<span class="ot">&lt;-</span>new_data[<span class="sc">!</span><span class="fu">complete.cases</span>(new_data), ]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>countries_dropped<span class="sc">$</span>Entity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Anguilla"                        "Bonaire Sint Eustatius and Saba"
 [3] "Cook Islands"                    "Western Sahara"                 
 [5] "Falkland Islands"                "Guernsey"                       
 [7] "Guadeloupe"                      "French Guiana"                  
 [9] "Jersey"                          "Saint Martin (French part)"     
[11] "Montserrat"                      "Martinique"                     
[13] "Mayotte"                         "Niue"                           
[15] "Reunion"                         "Saint Helena"                   
[17] "Saint Pierre and Miquelon"       "Tokelau"                        
[19] "Taiwan"                          "Vatican"                        
[21] "Wallis and Futuna"              </code></pre>
</div>
</div>
</section>
<section id="doing-a-scatterplot" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="doing-a-scatterplot"><span class="header-section-number">3.6</span> Doing a scatterplot</h2>
<p>We are now finally able to do simple scatterplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>fig1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>fig1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="saving-our-first-plot" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="saving-our-first-plot"><span class="header-section-number">3.7</span> Saving our first plot</h2>
<p>We can save our plot by using the following code!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(fig1, <span class="at">file =</span> <span class="st">"./fig1.jpg"</span>, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">20</span>, <span class="at">width =</span> <span class="dv">20</span>, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="ggplot-options" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> ggplot options</h1>
<p>Let us play a bit with the options in ggplot so that we make our graph nicer.</p>
<section id="improving-x-and-y-axis-labels" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="improving-x-and-y-axis-labels"><span class="header-section-number">4.1</span> Improving X and Y axis labels</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fig2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Urbanization"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Life Expectancy"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>fig2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="adding-a-title" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="adding-a-title"><span class="header-section-number">4.2</span> Adding a Title</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fig2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Urbanization"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Life Expectancy"</span>)<span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Example Title"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>fig2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="getting-rid-of-the-grey-background" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="getting-rid-of-the-grey-background"><span class="header-section-number">4.3</span> Getting rid of the grey background</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>fig2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Urbanization"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Life Expectancy"</span>)<span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Example Title"</span>)<span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>fig2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fitting-a-line" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="fitting-a-line"><span class="header-section-number">4.4</span> Fitting a line</h2>
<p>Let us fit a line to see if there is any relationship between urbanization and life expectancy. Is it the case that countries with higher levels of urbanization also have higher life expectancy?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fig2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Urbanization"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Life Expectancy"</span>)<span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Example Title"</span>)<span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>fig2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The blue line would indeed suggest that as the level of urbanization goes up, so does life expectancy.</p>
</section>
<section id="fixing-the-x-and-y-axis-to-particular-values" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="fixing-the-x-and-y-axis-to-particular-values"><span class="header-section-number">4.5</span> Fixing the X and Y axis to particular values</h2>
<p>But what if we fixed our axies to particular values. Woudl we still see the same effects?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fig3<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Urbanization"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Life Expectancy"</span>)<span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Example Title"</span>)<span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>fig3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s put the two graphs together. The first graph is the one in which we fix the x and y axis while the second one is the one in which we don’t.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(fig2, fig3, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This is interesting. So depending on how we present the data, the relationship may not <em>seem</em> as strong. However, the relationship is exactly the same. Thus, how you present the data matters!</p>
</section>
<section id="labelling-the-data" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="labelling-the-data"><span class="header-section-number">4.6</span> Labelling the data</h2>
<p>There are many ways of labeling the data in ggplot. But let us try a simple way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fig3<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Urbanization"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Life Expectancy"</span>)<span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Example Title"</span>)<span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Entity),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="dv">1</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> new_data2)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>fig3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What if we wanted to do selective labeling? Let’s say, we just want to label Italy and the US. How could we do that?</p>
<p>Well, we could create a new dataset based on a subset and then label the data.</p>
</section>
<section id="subsetting-the-data-to-two-countries" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="subsetting-the-data-to-two-countries"><span class="header-section-number">4.7</span> Subsetting the data to two countries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>countries_of_interest <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Italy"</span>, <span class="st">"United States"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>italy_us_df<span class="ot">&lt;-</span><span class="fu">subset</span>(new_data2, Entity <span class="sc">%in%</span>  countries_of_interest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lets-try-the-labelling-again" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="lets-try-the-labelling-again"><span class="header-section-number">4.8</span> Let’s try the labelling again</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fig4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Urbanization"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Life Expectancy"</span>)<span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Example Title"</span>)<span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Entity),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="dv">1</span>),</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> italy_us_df)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>fig4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Tis is not ideal. You can barely see the text. We should probably find a better way. The better way is called <code>geom_label</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fig4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Urbanization"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Life Expectancy"</span>)<span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Example Title"</span>)<span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> Entity),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="dv">1</span>),</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> italy_us_df)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>fig4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This is better. But still, which one is Italy and which one is the US?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>fig4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(new_data2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>urbanization, <span class="at">y=</span>life_expectancy)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Urbanization"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Life Expectancy"</span>)<span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Example Title"</span>)<span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_label_repel</span>(<span class="at">box.padding =</span> <span class="fl">0.5</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Entity),</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="dv">1</span>),</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> italy_us_df)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>fig4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So much better!</p>
</section>
</section>
<section id="creating-a-bar-plot" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Creating a bar plot</h1>
<p>We need to get to know our data better. What is the distribution of life expectancy. What about urbanization? We can create bar plots and then histograms.</p>
<p>Let’s create a frequency table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step1: Rounding the values</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>new_data2<span class="sc">$</span>life_expectancy_rounded<span class="ot">&lt;-</span><span class="fu">round</span>(new_data2<span class="sc">$</span>life_expectancy, <span class="dv">0</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>new_data2<span class="sc">$</span>urbanization_rounded<span class="ot">&lt;-</span><span class="fu">round</span>(new_data2<span class="sc">$</span>urbanization, <span class="dv">0</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(new_data2, <span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
# Groups:   Code [5]
  Code  Entity      life_expectancy urbanization life_expectancy_rounded urban…¹
  &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt;        &lt;dbl&gt;                   &lt;dbl&gt;   &lt;dbl&gt;
1 ABW   Aruba                  70.3         48.1                      70      48
2 AFG   Afghanistan            45.4         18.6                      45      19
3 AGO   Angola                 45.1         37.5                      45      38
4 ALB   Albania                68.3         40.4                      68      40
5 AND   Andorra                77.0         87.0                      77      87
# … with abbreviated variable name ¹​urbanization_rounded</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step2: Creating a frequency table</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>freq_table<span class="ot">&lt;-</span><span class="fu">table</span>(new_data2<span class="sc">$</span>life_expectancy_rounded)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>freq_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
38 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 
 1  2  3  4  4  5  5  2  2  4 11  6  5  6  4  5  6  6 10 10  6  6 12 11  5 11 
68 69 70 71 72 73 74 75 77 
 9 11 12 12  4  4  1  6  3 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step3: Turning the table into a dataframe</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>freq_table<span class="ot">&lt;-</span><span class="fu">data.frame</span>(freq_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step4: Inspecting the names</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(freq_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Var1" "Freq"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step5:Identifying how to extract the variable names</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(freq_table)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Var1"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(freq_table)[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Freq"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step6: Providing more intuitive names</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(freq_table)[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"life_expectancy_rounded"</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(freq_table)[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="st">"frequency"</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(freq_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "life_expectancy_rounded" "frequency"              </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step7: Inspecting variable types</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(freq_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   35 obs. of  2 variables:
 $ life_expectancy_rounded: Factor w/ 35 levels "38","43","44",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ frequency              : int  1 2 3 4 4 5 5 2 2 4 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step8: Turning factor variables into numeric</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>freq_table<span class="sc">$</span>life_expectancy_rounded<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">as.character</span>(freq_table<span class="sc">$</span>life_expectancy_rounded))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(freq_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   35 obs. of  2 variables:
 $ life_expectancy_rounded: num  38 43 44 45 46 47 48 49 50 51 ...
 $ frequency              : int  1 2 3 4 4 5 5 2 2 4 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step9: Creating the barplot</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>fig5<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> freq_table, <span class="fu">aes</span>(<span class="at">x=</span>life_expectancy_rounded, <span class="at">y=</span>frequency))<span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>fig5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can obtain a similar graph by using the <code>geom_histogram</code> option in ggplot. You will of course have to use some options.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>fig5_b<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> new_data2, <span class="fu">aes</span>(<span class="at">x=</span>life_expectancy))<span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>fig5_b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>fig5_b<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> new_data2, <span class="fu">aes</span>(<span class="at">x=</span>life_expectancy))<span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">col=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>fig5_b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>fig5_b<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> new_data2, <span class="fu">aes</span>(<span class="at">x=</span>life_expectancy))<span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">35</span>, <span class="at">col=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>fig5_b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(fig5, fig5_b, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="calculating-the-mean" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="calculating-the-mean"><span class="header-section-number">5.1</span> Calculating the mean</h2>
<p>We already know how to calculate the mean for our dataset. This is 61.243 which is obtained by typing <code>mean((new_data2$life_expectancy_rounded)</code></p>
<p>Let us put it in our graph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>mean_life_expectancy<span class="ot">&lt;-</span><span class="fu">mean</span>((new_data2<span class="sc">$</span>life_expectancy_rounded))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>fig6<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> freq_table, <span class="fu">aes</span>(<span class="at">x=</span>life_expectancy_rounded, <span class="at">y=</span>frequency))<span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>mean_life_expectancy, <span class="at">linetype=</span><span class="st">'dashed'</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>fig6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="adding-the-mean-to-the-graph" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="adding-the-mean-to-the-graph"><span class="header-section-number">5.2</span> Adding the mean to the graph</h2>
<p>Let us add some some text to indicate that the line is the mean life expectancy in our dataset. The way to do this is by using <code>annotate</code>.</p>
<p>Here is how we can do that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>text_to_add<span class="ot">&lt;-</span><span class="st">"Mean"</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>y_coord<span class="ot">&lt;-</span><span class="dv">11</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>x_coord<span class="ot">&lt;-</span><span class="fu">mean</span>((new_data2<span class="sc">$</span>life_expectancy_rounded))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>mean_life_expectancy<span class="ot">&lt;-</span><span class="fu">mean</span>((new_data2<span class="sc">$</span>life_expectancy_rounded))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>fig6<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> freq_table, <span class="fu">aes</span>(<span class="at">x=</span>life_expectancy_rounded, <span class="at">y=</span>frequency))<span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>mean_life_expectancy, <span class="at">linetype=</span><span class="st">'dashed'</span>, <span class="at">col =</span> <span class="st">'red'</span>)<span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">"text"</span>, </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">x=</span>x_coord, </span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>y_coord, </span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span>text_to_add,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">color=</span><span class="st">"red"</span>)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>fig6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Maybe we want to move the text a bit further to the left. We can subtract 2 from the x_coord.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>text_to_add<span class="ot">&lt;-</span><span class="st">"Mean"</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>y_coord<span class="ot">&lt;-</span><span class="dv">11</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>x_coord<span class="ot">&lt;-</span><span class="fu">mean</span>((new_data2<span class="sc">$</span>life_expectancy_rounded))<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>mean_life_expectancy<span class="ot">&lt;-</span><span class="fu">mean</span>((new_data2<span class="sc">$</span>life_expectancy_rounded))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>fig6<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> freq_table, <span class="fu">aes</span>(<span class="at">x=</span>life_expectancy_rounded, <span class="at">y=</span>frequency))<span class="sc">+</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>mean_life_expectancy, <span class="at">linetype=</span><span class="st">'dashed'</span>, <span class="at">col =</span> <span class="st">'red'</span>)<span class="sc">+</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">"text"</span>, </span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">x=</span>x_coord, </span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>y_coord, </span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span>text_to_add,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">color=</span><span class="st">"red"</span>)</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>fig6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="creating-a-line-plot" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Creating a line plot</h1>
<p>An important question is understanding how life expectancy might have evolved over time. Let us go back to the original dataset before calculating the averages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(life_expectancy, <span class="at">n=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Entity Code Year Life.expectancy.at.birth..historical.
1 Afghanistan  AFG 1950                                  27.7
2 Afghanistan  AFG 1951                                  28.0
3 Afghanistan  AFG 1952                                  28.4
4 Afghanistan  AFG 1953                                  28.9
5 Afghanistan  AFG 1954                                  29.2
6 Afghanistan  AFG 1955                                  29.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Renaming variable</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(life_expectancy)[<span class="dv">4</span>]<span class="ot">&lt;-</span><span class="st">"life_expectancy"</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(life_expectancy, <span class="at">n=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Entity Code Year life_expectancy
1 Afghanistan  AFG 1950            27.7
2 Afghanistan  AFG 1951            28.0
3 Afghanistan  AFG 1952            28.4
4 Afghanistan  AFG 1953            28.9
5 Afghanistan  AFG 1954            29.2
6 Afghanistan  AFG 1955            29.9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>fig7<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> life_expectancy, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> life_expectancy))<span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Entity))<span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>fig7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Unfortunately, we cannot make out much out of this graph, as we have way too many countries. It probably makes sense to focus on 1-2 coutries. Let’s take the US and the UK as an example.</p>
<section id="subsetting-the-sample-to-fewer-countries" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="subsetting-the-sample-to-fewer-countries"><span class="header-section-number">6.1</span> Subsetting the sample to fewer countries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>countries_of_interest<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"United Kingdom"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>df_us_uk<span class="ot">&lt;-</span><span class="fu">subset</span>(life_expectancy, Entity <span class="sc">%in%</span> countries_of_interest)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_us_uk, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Entity Code Year life_expectancy
19059 United Kingdom  GBR 1543           33.94
19060 United Kingdom  GBR 1548           38.82
19061 United Kingdom  GBR 1553           39.59
19062 United Kingdom  GBR 1558           22.38
19063 United Kingdom  GBR 1563           36.66
19064 United Kingdom  GBR 1568           39.67
19065 United Kingdom  GBR 1573           41.06
19066 United Kingdom  GBR 1578           41.56
19067 United Kingdom  GBR 1583           42.70
19068 United Kingdom  GBR 1588           37.05</code></pre>
</div>
</div>
<p>Let us now plot life expectancy only for the US and the UK.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>fig8<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_us_uk, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> life_expectancy))<span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Entity))<span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>fig8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="subsetting-the-sample-to-fewer-years" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="subsetting-the-sample-to-fewer-years"><span class="header-section-number">6.2</span> Subsetting the sample to fewer years</h2>
<p>It is kind of cool that in the UK, there is data that goes so far back. For comparison purposes, it might be a good idea to restrict our sample to the period after 1900.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df_us_uk_after1900<span class="ot">&lt;-</span><span class="fu">subset</span>(df_us_uk, Year<span class="sc">&gt;</span><span class="dv">1900</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_us_uk_after1900, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Entity Code Year life_expectancy
19178 United Kingdom  GBR 1901           46.93
19179 United Kingdom  GBR 1902           48.36
19180 United Kingdom  GBR 1903           49.54
19181 United Kingdom  GBR 1904           48.14
19182 United Kingdom  GBR 1905           49.92
19183 United Kingdom  GBR 1906           49.60
19184 United Kingdom  GBR 1907           50.56
19185 United Kingdom  GBR 1908           51.02
19186 United Kingdom  GBR 1909           51.67
19187 United Kingdom  GBR 1910           53.26</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>fig9<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_us_uk_after1900, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> life_expectancy))<span class="sc">+</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Entity))<span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>fig9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s color the two countries in red and blue so that the difference is clearer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fig9<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_us_uk_after1900, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> life_expectancy))<span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Entity))<span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'Red'</span>,<span class="st">'Blue'</span>))</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>fig9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab4_questions_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What is the year with the lowest life expectancy for the US?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a new df with the US</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>df_us_after1900<span class="ot">&lt;-</span><span class="fu">subset</span>(df_us_uk_after1900, Entity<span class="sc">==</span><span class="st">"United States"</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>df_us_after1900<span class="sc">$</span>Year[df_us_after1900<span class="sc">$</span>life_expectancy<span class="sc">==</span><span class="fu">min</span>(df_us_after1900<span class="sc">$</span>life_expectancy)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1918</code></pre>
</div>
</div>
<p>What is the year with the second lowest life expectancy for the US?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We need to save the second highest year with a low life expectancy</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>df_us_after1900[<span class="fu">order</span>(df_us_after1900<span class="sc">$</span>life_expectancy, <span class="fu">rev</span>(df_us_after1900<span class="sc">$</span>life_expectancy), <span class="at">decreasing =</span> <span class="cn">FALSE</span>), ][<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1901</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>second_lowest<span class="ot">&lt;-</span>df_us_after1900[<span class="fu">order</span>(df_us_after1900<span class="sc">$</span>life_expectancy, <span class="fu">rev</span>(df_us_after1900<span class="sc">$</span>life_expectancy), <span class="at">decreasing =</span> <span class="cn">FALSE</span>), ][<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>second_lowest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1901</code></pre>
</div>
</div>
<p>What is the year with the lowest life expectancy for the UK?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a new df with the UK</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>df_uk_after1900<span class="ot">&lt;-</span><span class="fu">subset</span>(df_us_uk_after1900, Entity<span class="sc">==</span><span class="st">"United Kingdom"</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>df_uk_after1900<span class="sc">$</span>Year[df_uk_after1900<span class="sc">$</span>life_expectancy<span class="sc">==</span><span class="fu">min</span>(df_uk_after1900<span class="sc">$</span>life_expectancy)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1901</code></pre>
</div>
</div>
<p>Great! We have gone over a variety of graphs in ggplot including points, barplots, and time lines. You are now in a very good position to do some basic data analysis in R.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="lab4_questions_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>